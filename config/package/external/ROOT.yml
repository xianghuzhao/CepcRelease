category: external
version: 5.34.18

dep: [GCC, CMake, GSL, QT]

location:
  source: source
  build: build
  install: install
path:
  home: '{install}'
  src: '{source}'
  bin: '{install}/bin'
  lib: '{install}/lib'
  inc: '{install}/include'
  man: '{install}/man'
env:
  ROOTSYS: '{install}'

install:
  download:
    handler: http
    param:
      url: https://root.cern.ch/download/root_v{version}.source.tar.gz
  extract:
    handler: tar
    param:
      file: root_v{version}.source.tar.gz
      main: root
  pre_compile:
    handler: patch
    param:
      file: root-5.34.18.patch
  compile:
    handler: conf_make
    param:
      ignore_install_prefix: true
      configure:
        - --fail-on-missing
        - --enable-builtin-afterimage
        - --enable-builtin-ftgl
        - --enable-builtin-freetype
        - --enable-builtin-glew
        - --enable-builtin-pcre
        - --enable-builtin-zlib
        - --enable-builtin-lzma
        - --enable-explicitlink
        - --enable-soversion
        - --enable-roofit
        - --enable-minuit2
        - --enable-gdml
        - --enable-table
        - --enable-unuran
        - --enable-gsl-shared
        - --with-gsl-incdir={GSL_inc_dir}
        - --with-gsl-libdir={GSL_lib_dir}
        - --enable-qt
        - --with-qt-incdir={QT_inc_dir}
        - --with-qt-libdir={QT_lib_dir}
        - --enable-python
      env_install:
        ROOTSYS: '{ROOT_root_dir}'
  post_compile:
    handler: lib
  clean:
    handler: clean
    param:
      dir: [build, download, log]
